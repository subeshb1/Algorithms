//eslint-disable-next-line
export default()=>{var _slicedToArray=function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,r){var e=[],o=!0,s=!1,i=void 0;try{for(var a,n=t[Symbol.iterator]();!(o=(a=n.next()).done)&&(e.push(a.value),!r||e.length!==r);o=!0);}catch(t){s=!0,i=t}finally{try{!o&&n.return&&n.return()}finally{if(s)throw i}}return e}(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function o(t,r){for(var e=0;e<r.length;e++){var o=r[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,r,e){return r&&o(t.prototype,r),e&&o(t,e),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}return Array.from(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var r,e=1;e<arguments.length;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},isDiagonal=function(t,r){return t.i!==r.i&&t.j!==r.j},search=function(t,r){var s=t.i,i=t.j;return r.find(function(t){var r=t.pos,e=r.i,o=r.j;return e===s&&o===i})},heuristic=function(t,r,e){return"DIAGONAL"===e?Math.max(Math.abs(t.i-r.i),Math.abs(t.j-r.j)):"EUCLIDEAN"===e?Math.pow(t.i-r.i,2)+Math.pow(t.j-r.j,2):Math.abs(t.i-r.i)+Math.abs(t.j-r.j)},getDistance=function(t,r){return isDiagonal(t.pos,r.pos)?14:10},isGoal=function(t,r){var e=t.i,o=t.j;return e===r.i&&o===r.j},GraphController=function(){function s(t,r,e){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,s),this.type=o,this.graph=t,this.maxRow=r,this.maxCol=e}return _createClass(s,[{key:"getAdjacent",value:function(t){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(0===this.type)return this.getAdjacentOne(t,r)}},{key:"getAdjacentOne",value:function(t){var r=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=t.pos,s=[{i:o.i+1,j:o.j},{i:o.i,j:o.j+1},{i:o.i-1,j:o.j},{i:o.i,j:o.j-1}];return e&&s.push.apply(s,[{i:o.i+1,j:o.j-1},{i:o.i+1,j:o.j+1},{i:o.i-1,j:o.j+1},{i:o.i-1,j:o.j-1}]),s.filter(function(t){return 0<=t.i&&t.i<r.maxRow&&0<=t.j&&t.j<r.maxCol}).map(function(t){return r.at(t)}).filter(function(t){return"BLOCK"!==t.color})}},{key:"at",value:function(t){if(0===this.type){var r=t,e=r.i,o=r.j;if((t=e*this.maxCol+o)>=this.graph.length)throw new TypeError("No Node Found of "+e+","+o);return this.graph[t]}return this.graph.nodes[t]}},{key:"getPos",value:function(t){var r=t.i,e=t.j;return r*this.maxCol+e}}]),s}(),BreadthFirstSearch=function(){function s(t,r,e){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,s),this._graph=new GraphController(t,r,e,o)}return _createClass(s,[{key:"search",value:function(t,r){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=this._graph.at(t),s=this._graph.getPos.bind(this._graph),i=[];o.color="VISITED",o.predecessor=void 0;for(var a=void(o.d=0),n=[o];0!==n.length;){var h=n.shift();if(h.pos.i===r.i&&h.pos.j===r.j){a=h;break}var l=!0,f=!1,c=void 0;try{for(var p,u=this._graph.getAdjacent(h,e)[Symbol.iterator]();!(l=(p=u.next()).done);l=!0){var d=p.value;"UNVISITED"===d.color&&(d.color="VISITED",d.predecessor=h,d.d=h.d+10,i.push({pos:s(d.pos),color:"VISITED",text:[{text:s(h.pos),offsetX:0,offsetY:2},{text:d.d,offsetX:0,offsetY:10}]}),n.push(d))}}catch(t){f=!0,c=t}finally{try{!l&&u.return&&u.return()}finally{if(f)throw c}}h.color="EXPLORED",i.push({pos:s(h.pos),color:"EXPLORED"})}if(a){var v="M "+(a.x+5)+","+(a.y+5),g=a.predecessor;for(v+="L "+(g.x+5)+","+(g.y+5);g.predecessor;)g.color="VISITED",i.push({pos:s(g.pos),color:"PATH"}),v+=" L "+((g=g.predecessor).x+5)+","+(g.y+5);i.push({path:v})}return i}}]),s}(),DepthFirstSearch=function(){function s(t,r,e){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,s),this._graph=new GraphController(t,r,e,o)}return _createClass(s,[{key:"search",value:function(t,r){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.diagonal=e,this.goal=r,this.action=[],this.time=0,this.getPos=this._graph.getPos.bind(this._graph);var o=this._graph.at(t);if(o.predecessor=void 0,this.final=void 0,this.dfs(o),this.final){var s="M "+(this.final.x+5)+","+(this.final.y+5),i=this.final.predecessor;for(s+="L "+(i.x+5)+","+(i.y+5);i.predecessor;)i.color="PATH",this.action.push({pos:this.getPos(i.pos),color:"PATH"}),s+=" L "+((i=i.predecessor).x+5)+","+(i.y+5);this.action.push({path:s})}return this.action}},{key:"dfs",value:function(t){if(this.time++,t.d=this.time,t.color="VISITED",this.action.push({pos:this.getPos(t.pos),color:"VISITED",text:[{text:t.d,offsetX:0,offsetY:2}]}),t.pos.i!==this.goal.i||t.pos.j!==this.goal.j){var r=!0,e=!1,o=void 0;try{for(var s,i=this._graph.getAdjacent(t,this.diagonal)[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var a=s.value;if(this.final)return;"UNVISITED"===a.color&&(a.predecessor=t,this.dfs(a))}}catch(t){e=!0,o=t}finally{try{!r&&i.return&&i.return()}finally{if(e)throw o}}t.color="EXPLORED",this.time++,t.f=this.time,this.action.push({pos:this.getPos(t.pos),color:"EXPLORED",text:[{text:t.d,offsetX:0,offsetY:2},{text:t.f,offsetX:0,offsetY:10}]}),this.final}else this.final=t}}]),s}(),Dijkstras=function(){function s(t,r,e){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,s),this._graph=new GraphController(t,r,e,o)}return _createClass(s,[{key:"search",value:function(t,r){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._graph.graph.forEach(function(t){t.d=1/0,t.predecessor=null});var o=this._graph.getPos.bind(this._graph);this._graph.at(t).d=0;for(var s=[],i=[].concat(_toConsumableArray(this._graph.graph)).filter(function(t){return"BLOCK"!==t.color}),a=[],n=void 0;i.length!==a.length;){var h=this._graph.graph.reduce(function(t,r){return r.d<t.d&&!r.visit?r:t},{d:1/0});if(!h.pos)break;if(h.pos.i===r.i&&h.pos.j===r.j){n=h;break}h.visit=!0,a.push(i[o(h.pos)]),s.push({pos:o(h.pos),color:"EXPLORED"});var l=!0,f=!1,c=void 0;try{for(var p,u=this._graph.getAdjacent(h,e)[Symbol.iterator]();!(l=(p=u.next()).done);l=!0){var d=p.value,v=h.d+getDistance(h,d);if(d.d>v&&(d.d=v,d.predecessor=h,s.push({pos:o(d.pos),color:"VISITED",text:[{text:o(h.pos),offsetX:0,offsetY:2},{text:d.d,offsetX:0,offsetY:10}]})),n)break}}catch(t){f=!0,c=t}finally{try{!l&&u.return&&u.return()}finally{if(f)throw c}}}if(n){var g="M "+(n.x+5)+","+(n.y+5),y=n.predecessor;for(g+="L "+(y.x+5)+","+(y.y+5);y.predecessor;)y.color="VISITED",s.push({pos:o(y.pos),color:"PATH"}),g+=" L "+((y=y.predecessor).x+5)+","+(y.y+5);s.push({path:g})}return s}}]),s}(),AStar=function(){function s(t,r,e){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,s),this._graph=new GraphController(t,r,e,o)}return _createClass(s,[{key:"search",value:function(t,r){for(var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=this._graph.getPos.bind(this._graph),s=[],i=[{pos:this._graph.at(t).pos,f:0,g:0}],a=[],n=void 0,h=[];i.length;){var l=i.reduce(function(t,r,e){return r.f<t.f?_extends({},r,{i:e}):t},{f:1/0,i:-1});if(-1===l.i)break;if(isGoal(l.pos,r)){n=l;break}h.push({pos:o(l.pos),color:"EXPLORED"}),i.splice(l.i,1);var f=!0,c=!1,p=void 0;try{for(var u,d=this._graph.getAdjacent(l,e)[Symbol.iterator]();!(f=(u=d.next()).done);f=!0){var v=u.value,g=10*heuristic(v.pos,r),y=getDistance(l,v)+l.g,j=g+y,_=a[o(v.pos)];if(!_||_&&_.f>j){var x=s[o(v.pos)];(!x||x&&x.f>j)&&(i.push({pos:v.pos,f:j,g:y,predecessor:l}),s[o(v.pos)]={pos:v.pos,f:j,g:y,predecessor:l},h.push({pos:o(v.pos),color:"VISITED",text:[{text:j,offsetX:0,offsetY:2},{text:g,offsetX:0,offsetY:10},{text:y,offsetX:6,offsetY:10}]}))}}}catch(t){c=!0,p=t}finally{try{!f&&d.return&&d.return()}finally{if(c)throw p}}if(n)break;a[o(l.pos)]=l}if(n){var C=this._graph.at(n.pos),b="M "+(C.x+5)+","+(C.y+5),E=n.predecessor,A=this._graph.at(E.pos);for(b+="L "+(A.x+5)+","+(A.y+5);E.predecessor;)E.color="VISITED",h.push({pos:o(E.pos),color:"PATH"}),E=E.predecessor,b+=" L "+((A=this._graph.at(E.pos)).x+5)+","+(A.y+5);h.push({path:b})}return h}}]),s}();self.onmessage=function(t){var r=_slicedToArray(t.data,6),e=r[0],o=r[1],s=o.graph,i=o.col,a=o.row,n=_slicedToArray(r[2],2),h=n[0],l=n[1],f=_slicedToArray(r[3],2),c=f[0],p=f[1],u=r[4],d=r[5],v=void 0===d?0:d;s.length||self.postMessage([]);var g="dfs"===e?new DepthFirstSearch(s,a,i,v):"a-star"===e?new AStar(s,a,i,v):"dijkstras"===e?new Dijkstras(s,a,i,v):new BreadthFirstSearch(s,a,i,v);self.postMessage(g.search({i:h,j:l},{i:c,j:p},u))};};